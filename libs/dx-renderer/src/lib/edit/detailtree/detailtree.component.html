<div [class]="'mt-2 dx-texteditor-label' + !((visible$ | async) ?? false) ? ' hidden' : ''" [style.position]="'relative'">{{layoutItem?.options?.caption ?? ''}}</div>
<dx-tree-list *ngIf="!showSource && columns" #grid
    [visible]="((visible$ | async) ?? false)"
    [height]="height" 
    width="100%"
    [repaintChangesOnly]="true"
    [columnAutoWidth]="true"    
    [allowColumnResizing]="true"
    [columns]="columns"
    [dataSource]="value"
    [dataStructure]="'tree'"
    [itemsExpr]="'items'"
    (onToolbarPreparing)="onToolbarPreparing($event)"
    (onEditorPreparing)="onEditorPreparing($event)"
    (onInitNewRow)="onInitNewRow($event)"
    (onRowValidating)="onRowValidating($event)">
    <dxo-editing mode="cell" [useIcons]="true" 
        [allowAdding]="allowAdd" 
        [allowUpdating]="allowUpdate" 
        [allowDeleting]="allowDelete">
    </dxo-editing>
    <div *dxTemplate="let cell of 'dynamic'">
        <ballware-edit-dynamic-column [editing]="false" [dataMember]="cell.column.editorOptions.dataMember" [item]="cell.data" [column]="cell.column.editorOptions" ></ballware-edit-dynamic-column>
    </div>
    <div *dxTemplate="let cell of 'dynamicedit'">
        <ballware-edit-dynamic-column [editing]="true" [dataMember]="cell.column.editorOptions.dataMember" [item]="cell.data" [column]="cell.column.editorOptions" ></ballware-edit-dynamic-column>
    </div>    
</dx-tree-list>
<dx-toolbar class="w-100" *ngIf="showSource && sourceToolbarItems" [items]="sourceToolbarItems">    
</dx-toolbar>
<ballware-edit-json *ngIf="showSource" [initialLayoutItem]="layoutItem" ></ballware-edit-json>